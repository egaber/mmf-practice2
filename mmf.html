<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MMF Practice</title>
<style>
.top-buffer { margin-top:5px; }
</style>
<script type='application/javascript' src='js/fastclick.js'></script>
    <!-- Bootstrap -->

<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
<div class="container text-center">

<div class="progress">
  <div id="questions-bar" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
    
Q<span id="qnum">1</span>
  </div>
</div>
<div class="progress">
  <div id="time-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
    
  </div>
</div>

<h1>
<span id="num1">_</span>+<span id="num2">_</span>=<span id="ans">__</span>
</h1>

<div id="keys">
<div class="row top-buffer">
<button type="button" value="7" class="btn btn-primary btn-lg">7</button>
<button type="button" value="8" class="btn btn-primary btn-lg">8</button>
<button type="button" value="9" class="btn btn-primary btn-lg">9</button>
</div>
<div class="row top-buffer">
<button type="button" value="4" class="btn btn-primary btn-lg">4</button>
<button type="button" value="5" class="btn btn-primary btn-lg">5</button>
<button type="button" value="6" class="btn btn-primary btn-lg">6</button>
</div>
<div class="row top-buffer">
<button type="button" value="1" class="btn btn-primary btn-lg">1</button>
<button type="button" value="2" class="btn btn-primary btn-lg">2</button>
<button type="button" value="3" class="btn btn-primary btn-lg">3</button>
</div>
<div class="row top-buffer">
<button type="button" value="0" class="btn btn-primary btn-lg">0</button>
<button type="button" id="btnDel" disabled value="D" class="btn btn-danger btn-lg">DEL</button>
</div>

<button type="button" value="go" id="btnGo" disabled class="btn btn-success btn-lg top-buffer">&nbsp;&nbsp;&nbsp;GO&nbsp;&nbsp;&nbsp;</button>
</div>
</div> <!-- /.container -->

<div id="modalFinished" class="modal fade" data-backdrop="static">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="finishedMsg" class="modal-title"></h4>
      </div>
      <div class="modal-body">
	<div>Correct answers: <span id="correctAnswers"/></div>
	<div>Total questions: <span id="totalQuestions"/></div>
	<div>Incorrect answers:</div>
	<div>
		<ul id="incorrectAnswers">
			
		</ul>
	</div>
      </div>
      <div class="modal-footer">
        <button type="button" id="btnTryAgain" class="btn btn-primary">Try again</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->

<!-- Optional theme -->
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script>
var questionNum = 1;
var maxQuestions = 10;
var correctAnswers = 0;
var mistakes = "";
var timeSeconds = 10;

function showFinishedModal(title) {
	$("#finishedMsg").text(title);
	$("#correctAnswers").text(correctAnswers);
	$("#totalQuestions").text(questionNum - 1);
	$("#incorrectAnswers").html(mistakes);
	$("#modalFinished").modal("show");	
}


$(function() {
    FastClick.attach(document.body);
});

$(function() {

$("#btnTryAgain").click(function() {
	location.reload(true);

});

$("#ans").text("__");


$("#num1").text(Math.floor(Math.random() * 10));
$("#num2").text(Math.floor(Math.random() * 10));

$("#time-bar").animate({ width: "100%" }, {duration: timeSeconds * 1000, easing: "linear", 
		done: function() {
			showFinishedModal("Sorry, time is up!");
		}
	});

});


$("#keys button").click(function() {
console.log("button click val=" + $(this).val());

var val = $(this).val();
var ans = $("#ans").text();

if (!isNaN(val)) {
	console.log("number key clicked");

	console.log("current answer=" + ans);
	
	if (ans == "__") {
		$("#ans").text(val);
		$("#btnGo").removeAttr("disabled");
		$("#btnDel").removeAttr("disabled");
	} else {
		if (ans.length == 2) {
			return; // max 2 digits
		}
		
		$("#ans").text(ans + val);
	
	}
} else {
	switch(val) {
		case "D":
			console.log("Del clicked");
			if (ans.length == 1) {
				$("#ans").text("__");
				$("#btnGo").attr("disabled", "disabled");
				$("#btnDel").attr("disabled", "disabled");
			} else {
				$("#ans").text(ans.substring(0, ans.length - 1));
				$("#btnDel").removeAttr("disabled");
			}
			break;

		case "go":
			console.log("Go clicked " + questionNum);
			questionNum++;
			
			// check answer
			var num1 = parseInt($("#num1").text());
			var num2 = parseInt($("#num2").text());

			var sum = num1 + num2;

			console.log("sum=" + sum);
			
			$("#result").removeClass("alert-success alert-danger");	
			if (sum == ans) {
				correctAnswers++;
			} else {
				mistakes += "<li> " + num1 + " + " + num2 + " = " + sum + ",  not " + ans + "</li>";
			}


			$("#qnum").text(questionNum);	
			$("#ans").text("__");

			$("#questions-bar").css("width", (questionNum * 100 / maxQuestions) + "%");


			if (questionNum == maxQuestions) {
				$("#time-bar").stop();
				showFinishedModal("Finished all questions!");
				return;
			}

			$("#num1").text(Math.floor(Math.random() * 10));
			$("#num2").text(Math.floor(Math.random() * 10));

			$("#btnGo").attr("disabled", "disabled");
			$("#btnDel").attr("disabled", "disabled");
			break;

	}

}


});

</script>
</body>
</html>
